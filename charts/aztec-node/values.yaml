# -- Overrides the chart name
nameOverride: ""
# -- Overrides the chart computed fullname
fullnameOverride: ""

# =====================================================================
# DEPLOYMENT ROLE
# =====================================================================

# -- Role determines the type of Aztec node deployment
# Valid roles: fullnode, sequencer, prover
role: sequencer

# =====================================================================
# SEQUENCER CONFIGURATION (only used when role: sequencer)
# =====================================================================

sequencer:
  # -- Ethereum private key for attester (signs blocks and attestations)
  # REQUIRED when role is 'sequencer'
  attesterPrivateKey: ""
  # -- Aztec address (32 bytes) to receive unburnt transaction fees
  # feeRecipient: "0x0000000000000000000000000000000000000000000000000000000000000000"

# =====================================================================
# PROVER CONFIGURATION (only used when role: prover)
# =====================================================================
# When role is 'prover', creates 3 StatefulSets:
# - prover-broker: Manages job queue
# - prover-node: Creates jobs and submits proofs to L1
# - prover-agent: Executes proof generation

prover:
  # Prover node configuration
  node:
    # -- Ethereum private key for publishing proofs to L1
    # REQUIRED when role is 'prover'
    publisherPrivateKey: ""
    # -- Resource requests/limits for prover-node pod
    resources: {}
    # -- Persistence configuration for prover-node
    # Prover-node needs 1TB NVMe SSD for archiver data
    persistence:
      size: 1000Gi

  # Prover broker configuration
  broker:
    # -- Resource requests/limits for prover-broker pod
    resources: {}
    # -- Persistence configuration for prover-broker
    # Broker needs 10GB SSD for job queue
    persistence:
      size: 10Gi

  # Prover agent configuration
  agent:
    # -- Number of prover agent replicas
    replicas: 1
    # -- Number of prover agents to run per pod
    count: 1
    # -- Agent polling interval in milliseconds
    pollIntervalMs: 1000
    # -- Resource requests/limits for prover-agent pods
    # Recommended: 32 cores, 128GB RAM per agent
    resources: {}
    # -- Persistence configuration for prover-agent
    # Agent needs 10GB SSD per agent for CRS and temporary files
    persistence:
      size: 10Gi

  # -- Prover ID - address for receiving proof rewards
  # Used by prover-node (usually matches publisherPrivateKey address)
  id: ""

# =====================================================================
# IMAGE CONFIGURATION
# =====================================================================

# -- Image to use for the container
image:
  # -- Image repository
  repository: aztecprotocol/aztec
  # -- Image tag
  tag: 2.1.0-rc.24
  # -- Container pull policy
  pullPolicy: IfNotPresent

# =====================================================================
# NETWORK CONFIGURATION
# =====================================================================

# -- Pod management policy
podManagementPolicy: Parallel

# -- Network name - this is a predefined network - testnet, devnet
network:

# -- Network identifier used in resource naming (l2-{role}-node-{networkName}-{component})
# This appears in service/statefulset names for easy identification
networkName: staging-public

# -- Custom network - (not recommended) - Only for custom testnet usecases
# Must have deployed your own protocol contracts first
customNetwork:
  l1ChainId:
  registryContractAddress:
  slashFactoryAddress:
  feeAssetHandlerContractAddress:

# -- Which rollup contract we want to follow from the registry
rollupVersion: "canonical"

# -- Use host network - provides best P2P performance by binding directly to node's network
# This is the recommended configuration for Aztec nodes
hostNetwork: true

# -- Pod annotations (e.g., for Keel auto-updates)
podAnnotations: {}

# =====================================================================
# NODE CONFIGURATION
# =====================================================================

# -- Aztec node configuration
node:
  # -- Number of replicas
  replicas: 1

  # -- Log level - info, verbose, debug, trace
  logLevel: "info"

  # -- L1 Ethereum configuration
  # Ethereum execution layer RPC endpoint(s) - comma separated list
  l1ExecutionUrls: ["http://l1-full-node-sepolia-execution.l1.svc.cluster.local:8545"]
  # L1 consensus layer RPC endpoint(s) - comma separated list
  l1ConsensusUrls: ["http://l1-full-node-sepolia-beacon.l1.svc.cluster.local:5052"]
  ## Only when api key is required via header, otherwise just provide in l1ConsensusUrls
  ## Example: "1234abcd"
  l1ConsensusHostApiKeys: []
  ## Example: "X-API-KEY"
  l1ConsensusHostApiKeyHeaders: []

  # -- Pre-start script (runs before node starts)
  preStartScript: ""

  # -- Start command flags
  # Auto-generated based on role, but can be overridden for custom configurations
  # Leave empty to use role-based defaults
  startCmd: []

  # -- Remote service URLs
  remoteUrl:
    archiver:
    proverBroker:
    proverCoordinationNodes: []
    blobSink:

  # -- Address that will receive block or proof rewards
  # For prover roles, this is the PROVER_ID
  coinbase:

  # -- Sentinel configuration - gathers slashing information
  sentinel:
    enabled: false

  # -- Metrics configuration
  metrics:
    # Exclude metrics - comma separated list of metrics to exclude
    otelExcludeMetrics: ""
    # Collector endpoint - e.g. http://localhost:4318
    otelCollectorEndpoint: ""
    # Use GCP logging
    useGcloudLogging: false

  # -- Storage configuration
  storage:
    # Data directory
    dataDirectory: /data
    # Data store map size in kB (per database)
    dataStoreMapSize: "134217728"  # 128 GB
    # World state map size in kB (per merkle tree)
    worldStateMapSize: "134217728"  # 128 GB
    # P2P storage map size (kB)
    p2pStorageMapSize:
    # Archive storage map size (kB)
    archiveStorageMapSize:

  # -- Node.js options
  nodeJsOptions:
      - --no-warnings
      - --max-old-space-size=4096

  # -- Startup probe configuration
  startupProbe:
    # Period seconds
    periodSeconds: 30
    # Failure threshold (10 minutes default - may need more if downloading many blocks)
    failureThreshold: 20

  # -- Resource requests and limits
  resources: {}

# =====================================================================
# PERSISTENCE
# =====================================================================

persistence:
  # -- Uses an emptyDir when not enabled
  enabled: false
  # -- Use an existing PVC
  existingClaim: null
  # -- AccessModes
  accessModes:
  - ReadWriteOnce
  # -- Requested size
  size: 100Gi
  # -- Use a specific storage class
  storageClassName: null
  # -- Annotations for volume claim template
  annotations: {}
  # -- Selector for volume claim template
  selector: {}

# =====================================================================
# STATEFULSET CONFIGURATION
# =====================================================================

# -- Update strategy for the statefulset
updateStrategy:
  type: RollingUpdate

# -- Additional init containers
initContainers: []
# - name: my-init-container
#   image: busybox:latest
#   command: ['sh', '-c', 'echo hello']

# =====================================================================
# SERVICE CONFIGURATION
# =====================================================================

service:
  ingress:
    enabled: false
    annotations: {}
    # kubernetes.io/ingress.global-static-ip-name: my-static-ip
    hosts: []
    # - node.example.com

  headless:
    enabled: true

  p2p:
    enabled: true
    # NodePort is an alternative to hostNetwork for external P2P access
    # Only used when hostNetwork: false
    nodePortEnabled: false
    port: 40400
    # NodePort must be in range 30000-32767 (Kubernetes limitation)
    # This is the external port exposed on the node, which forwards to internal port 40400
    nodePort: 30400
    announcePort: 40400

  admin:
    enabled: true
    port: 8081

  httpPort: 8080

# =====================================================================
# CERTIFICATE CONFIGURATION
# =====================================================================

# Certificate configuration
certificate:
  enabled: false
  domains: []
  # - example.com
  # - api.example.com

# =====================================================================
# RBAC CONFIGURATION
# =====================================================================

rbac:
  # -- Specifies whether RBAC resources are to be created
  create: true
  # -- Required ClusterRole rules
  # @default -- See `values.yaml`
  clusterRules:
     # Required to obtain the nodes external IP
    - apiGroups: [""]
      resources:
      - "nodes"
      verbs:
      - "get"
      - "list"
      - "watch"
  # -- Required ClusterRole rules
  # @default -- See `values.yaml`
  rules:
    # Required to get information about the services nodePort.
    - apiGroups: [""]
      resources:
      - "services"
      verbs:
      - "get"
      - "list"
      - "watch"

# =====================================================================
# SERVICE ACCOUNT
# =====================================================================

serviceAccount:
  # -- Create a service account
  create: true
  # -- Name of the service account - if not set, the fullname will be used
  name: ""
  # -- Annotations for the service account
  annotations: {}
