apiVersion: v1
kind: Pod
metadata:
  name: debug-helm-test-conditions-pod
  namespace: {{ .Release.Namespace }}
  annotations:
    "helm.sh/hook": test
    "helm.sh/hook-delete-policy": "before-hook-creation"
    "helm.sh/hook-weight": "-5" # Try to run it early
spec:
  restartPolicy: Never
  containers:
    - name: debug-output
      image: alpine:latest
      command: ['sh', '-c']
      args:
        - |
          echo "--- DEBUGGING Helm Test Conditions ---"
          echo "Timestamp: $(date)"
          echo "Release Name: {{ .Release.Name }}"
          echo "Values.charon.enr.generate.enabled: {{ .Values.charon.enr.generate.enabled | quote }}"
          echo "Values.charon.enr.privateKey: {{ .Values.charon.enr.privateKey | quote }}"
          echo "Values.charon.enr.existingSecret.name: {{ .Values.charon.enr.existingSecret.name | quote }}"
          echo "[Default ENR Test Condition Evaluation]"
          echo "Raw 'and' condition: {{ and .Values.charon.enr.generate.enabled (not .Values.charon.enr.privateKey) (not .Values.charon.enr.existingSecret.name) }}"
          echo "[Existing ENR Secret Test Condition Evaluation]"
          echo "Raw 'and' condition: {{ and (eq .Values.charon.enr.generate.enabled false) (ne .Values.charon.enr.existingSecret.name "") }}"
          echo "--- END DEBUGGING ---"
