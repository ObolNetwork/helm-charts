{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "type": "object",
    "properties": {
        "affinity": {
            "type": "object"
        },
        "channels": {
            "description": "Chat channel integrations Tokens are stored in the chart Secret and injected as env vars.",
            "type": "object",
            "properties": {
                "discord": {
                    "type": "object",
                    "properties": {
                        "botToken": {
                            "description": "Discord bot token",
                            "type": "string"
                        },
                        "dmPolicy": {
                            "description": "DM policy: \"open\" | \"paired\" | \"closed\"",
                            "type": "string"
                        },
                        "enabled": {
                            "type": "boolean"
                        }
                    }
                },
                "slack": {
                    "type": "object",
                    "properties": {
                        "appToken": {
                            "description": "Slack App-Level Token (xapp-...)",
                            "type": "string"
                        },
                        "botToken": {
                            "description": "Slack Bot User OAuth Token (xoxb-...)",
                            "type": "string"
                        },
                        "enabled": {
                            "type": "boolean"
                        }
                    }
                },
                "telegram": {
                    "type": "object",
                    "properties": {
                        "botToken": {
                            "description": "Telegram Bot API token (from @BotFather)",
                            "type": "string"
                        },
                        "dmPolicy": {
                            "description": "DM policy: \"open\" | \"paired\" | \"closed\"",
                            "type": "string"
                        },
                        "enabled": {
                            "type": "boolean"
                        }
                    }
                }
            }
        },
        "config": {
            "description": "Configuration for the OpenClaw config file (openclaw.json)",
            "type": "object",
            "properties": {
                "content": {
                    "description": "Optional raw JSON5 configuration (overrides generated config when set)",
                    "type": "string"
                },
                "existingConfigMap": {
                    "description": "Use an existing ConfigMap instead of creating one",
                    "type": "string"
                },
                "key": {
                    "description": "ConfigMap key / filename",
                    "type": "string"
                }
            }
        },
        "containerSecurityContext": {
            "description": "Container security context",
            "type": "object",
            "properties": {
                "allowPrivilegeEscalation": {
                    "type": "boolean"
                },
                "capabilities": {
                    "type": "object",
                    "properties": {
                        "drop": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            }
                        }
                    }
                },
                "runAsGroup": {
                    "type": "integer"
                },
                "runAsNonRoot": {
                    "type": "boolean"
                },
                "runAsUser": {
                    "type": "integer"
                },
                "seccompProfile": {
                    "type": "object",
                    "properties": {
                        "type": {
                            "type": "string"
                        }
                    }
                }
            }
        },
        "erpc": {
            "description": "eRPC integration (exposed as ERPC_URL env var)",
            "type": "object",
            "properties": {
                "url": {
                    "type": "string"
                }
            }
        },
        "extraEnv": {
            "description": "Additional environment variables",
            "type": "array"
        },
        "extraVolumeMounts": {
            "description": "Additional volume mounts",
            "type": "array"
        },
        "extraVolumes": {
            "description": "Additional volumes",
            "type": "array"
        },
        "fullnameOverride": {
            "description": "Override the full resource name",
            "type": "string"
        },
        "httpRoute": {
            "description": "Gateway API HTTPRoute (recommended for Obol Stack / Traefik Gateway API)",
            "type": "object",
            "properties": {
                "annotations": {
                    "type": "object"
                },
                "enabled": {
                    "type": "boolean"
                },
                "hostnames": {
                    "description": "Hostnames for routing (required when enabled)",
                    "type": "array"
                },
                "parentRefs": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "name": {
                                "type": "string"
                            },
                            "namespace": {
                                "type": "string"
                            },
                            "sectionName": {
                                "type": "string"
                            }
                        }
                    }
                },
                "pathPrefix": {
                    "type": "string"
                }
            }
        },
        "image": {
            "description": "OpenClaw image repository, pull policy, and tag version",
            "type": "object",
            "properties": {
                "args": {
                    "description": "Override the container args (CMD)",
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "command": {
                    "description": "Override the container command (ENTRYPOINT)",
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "env": {
                    "description": "Additional environment variables for the container",
                    "type": "array"
                },
                "pullPolicy": {
                    "type": "string"
                },
                "repository": {
                    "type": "string"
                },
                "tag": {
                    "type": "string"
                }
            }
        },
        "imagePullSecrets": {
            "description": "Credentials to fetch images from private registry",
            "type": "array"
        },
        "ingress": {
            "description": "Kubernetes Ingress (optional; not used in Obol Stack which uses Gateway API)",
            "type": "object",
            "properties": {
                "annotations": {
                    "type": "object"
                },
                "className": {
                    "type": "string"
                },
                "enabled": {
                    "type": "boolean"
                },
                "hosts": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "host": {
                                "type": "string"
                            },
                            "paths": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "properties": {
                                        "path": {
                                            "type": "string"
                                        },
                                        "pathType": {
                                            "type": "string"
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "tls": {
                    "type": "array"
                }
            }
        },
        "initJob": {
            "description": "One-shot init Job (runs once to bootstrap workspace/personality)",
            "type": "object",
            "properties": {
                "args": {
                    "type": "array"
                },
                "command": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "enabled": {
                    "description": "Enable a one-shot post-install bootstrap Job. Requires persistence.enabled=true.",
                    "type": "boolean"
                },
                "env": {
                    "description": "Extra environment variables for the init job",
                    "type": "array"
                },
                "image": {
                    "type": "object",
                    "properties": {
                        "pullPolicy": {
                            "type": "string"
                        },
                        "repository": {
                            "type": "string"
                        },
                        "tag": {
                            "type": "string"
                        }
                    }
                },
                "resources": {
                    "description": "Resource requests/limits for the init job",
                    "type": "object",
                    "properties": {
                        "limits": {
                            "type": "object",
                            "properties": {
                                "memory": {
                                    "type": "string"
                                }
                            }
                        },
                        "requests": {
                            "type": "object",
                            "properties": {
                                "cpu": {
                                    "type": "string"
                                },
                                "memory": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        },
        "livenessProbe": {
            "description": "Liveness probe (tcpSocket by default to avoid auth-protected HTTP endpoints)",
            "type": "object",
            "properties": {
                "enabled": {
                    "type": "boolean"
                },
                "failureThreshold": {
                    "type": "integer"
                },
                "initialDelaySeconds": {
                    "type": "integer"
                },
                "periodSeconds": {
                    "type": "integer"
                },
                "timeoutSeconds": {
                    "type": "integer"
                }
            }
        },
        "models": {
            "description": "Model provider configuration Each provider is independently toggled. All providers may be disabled. API keys are stored in the chart Secret and injected as env vars.",
            "type": "object",
            "properties": {
                "anthropic": {
                    "type": "object",
                    "properties": {
                        "api": {
                            "type": "string"
                        },
                        "apiKeyEnvVar": {
                            "type": "string"
                        },
                        "apiKeyValue": {
                            "description": "API key value (stored in Secret). Leave empty to provide via extraEnvFromSecrets.",
                            "type": "string"
                        },
                        "baseUrl": {
                            "type": "string"
                        },
                        "enabled": {
                            "type": "boolean"
                        },
                        "models": {
                            "type": "array",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "id": {
                                        "type": "string"
                                    },
                                    "name": {
                                        "type": "string"
                                    }
                                }
                            }
                        }
                    }
                },
                "ollama": {
                    "type": "object",
                    "properties": {
                        "api": {
                            "description": "OpenClaw provider API type. Set to \"openai-completions\" because llmspy exposes an OpenAI-compatible chat/completions endpoint.",
                            "type": "string"
                        },
                        "apiKeyEnvVar": {
                            "description": "Env var used for provider API key interpolation in openclaw.json",
                            "type": "string"
                        },
                        "apiKeyValue": {
                            "description": "Value set for the apiKey env var (not a secret for Ollama)",
                            "type": "string"
                        },
                        "baseUrl": {
                            "description": "OpenAI-compatible base URL for Ollama (routed through llmspy global proxy)",
                            "type": "string"
                        },
                        "enabled": {
                            "type": "boolean"
                        },
                        "models": {
                            "type": "array",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "id": {
                                        "type": "string"
                                    },
                                    "name": {
                                        "type": "string"
                                    }
                                }
                            }
                        }
                    }
                },
                "openai": {
                    "type": "object",
                    "properties": {
                        "api": {
                            "type": "string"
                        },
                        "apiKeyEnvVar": {
                            "type": "string"
                        },
                        "apiKeyValue": {
                            "type": "string"
                        },
                        "baseUrl": {
                            "type": "string"
                        },
                        "enabled": {
                            "type": "boolean"
                        },
                        "models": {
                            "type": "array",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "id": {
                                        "type": "string"
                                    },
                                    "name": {
                                        "type": "string"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "nameOverride": {
            "description": "Override the chart name",
            "type": "string"
        },
        "nodeSelector": {
            "type": "object"
        },
        "openclaw": {
            "description": "OpenClaw state/workspace settings (paths should be inside persistence.mountPath)",
            "type": "object",
            "properties": {
                "agentModel": {
                    "description": "Default agent model (e.g. \"anthropic/claude-sonnet-4-5-20250929\"). Empty = use provider default.",
                    "type": "string"
                },
                "gateway": {
                    "type": "object",
                    "properties": {
                        "auth": {
                            "type": "object",
                            "properties": {
                                "mode": {
                                    "type": "string"
                                }
                            }
                        },
                        "bind": {
                            "type": "string"
                        },
                        "controlUi": {
                            "description": "Control UI settings for browser-based access.",
                            "type": "object"
                        },
                        "http": {
                            "type": "object",
                            "properties": {
                                "endpoints": {
                                    "type": "object",
                                    "properties": {
                                        "chatCompletions": {
                                            "type": "object",
                                            "properties": {
                                                "enabled": {
                                                    "type": "boolean"
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "mode": {
                            "type": "string"
                        },
                        "trustedProxies": {
                            "description": "IP addresses / CIDRs whose proxy headers (X-Forwarded-For etc.) are trusted. Required when OpenClaw sits behind a reverse proxy (e.g. Traefik in k3d).",
                            "type": "array"
                        }
                    }
                },
                "stateDir": {
                    "type": "string"
                },
                "workspaceDir": {
                    "type": "string"
                }
            }
        },
        "persistence": {
            "description": "Persistence settings for OpenClaw state directory (contains runtime state + secrets)",
            "type": "object",
            "properties": {
                "accessModes": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "enabled": {
                    "type": "boolean"
                },
                "existingClaim": {
                    "type": "string"
                },
                "mountPath": {
                    "type": "string"
                },
                "size": {
                    "type": "string"
                },
                "storageClass": {
                    "type": "string"
                }
            }
        },
        "podAnnotations": {
            "description": "Pod annotations",
            "type": "object"
        },
        "podLabels": {
            "description": "Pod labels",
            "type": "object"
        },
        "podSecurityContext": {
            "description": "Pod security context",
            "type": "object",
            "properties": {
                "fsGroup": {
                    "type": "integer"
                }
            }
        },
        "priorityClassName": {
            "type": "string"
        },
        "rbac": {
            "description": "RBAC for the ServiceAccount (read-only access to namespace resources)",
            "type": "object",
            "properties": {
                "create": {
                    "type": "boolean"
                },
                "extraRules": {
                    "description": "Extra rules to append to the generated Role (list of PolicyRule objects)",
                    "type": "array"
                }
            }
        },
        "readinessProbe": {
            "description": "Readiness probe (tcpSocket by default to avoid auth-protected HTTP endpoints)",
            "type": "object",
            "properties": {
                "enabled": {
                    "type": "boolean"
                },
                "failureThreshold": {
                    "type": "integer"
                },
                "initialDelaySeconds": {
                    "type": "integer"
                },
                "periodSeconds": {
                    "type": "integer"
                },
                "timeoutSeconds": {
                    "type": "integer"
                }
            }
        },
        "replicaCount": {
            "description": "Number of replicas (OpenClaw should run as a single instance)",
            "type": "integer"
        },
        "resources": {
            "description": "Resource requests and limits",
            "type": "object",
            "properties": {
                "limits": {
                    "type": "object",
                    "properties": {
                        "memory": {
                            "type": "string"
                        }
                    }
                },
                "requests": {
                    "type": "object",
                    "properties": {
                        "cpu": {
                            "type": "string"
                        },
                        "memory": {
                            "type": "string"
                        }
                    }
                }
            }
        },
        "secrets": {
            "description": "OpenClaw secrets (one Secret per instance)",
            "type": "object",
            "properties": {
                "create": {
                    "description": "Create the secret when existingSecret is not set",
                    "type": "boolean"
                },
                "existingSecret": {
                    "description": "Use an existing secret instead of creating one",
                    "type": "string"
                },
                "extraEnvFromSecrets": {
                    "description": "Extra Secret names to load via envFrom (for provider/channel keys, etc.)",
                    "type": "array"
                },
                "gatewayToken": {
                    "type": "object",
                    "properties": {
                        "key": {
                            "description": "Secret key name + env var name for the gateway API authentication token. This token is required to access OpenClaw's HTTP gateway (chat/completions endpoint and dashboard).",
                            "type": "string"
                        },
                        "value": {
                            "description": "Explicit token value. Required for token auth unless using secrets.existingSecret.",
                            "type": "string"
                        }
                    }
                },
                "name": {
                    "description": "Override the created Secret name (defaults to \u003crelease\u003e-openclaw-secrets)",
                    "type": "string"
                }
            }
        },
        "service": {
            "description": "Service configuration",
            "type": "object",
            "properties": {
                "port": {
                    "type": "integer"
                },
                "type": {
                    "type": "string"
                }
            }
        },
        "serviceAccount": {
            "description": "Create a ServiceAccount for OpenClaw",
            "type": "object",
            "properties": {
                "annotations": {
                    "type": "object"
                },
                "automount": {
                    "description": "Automatically mount a ServiceAccount's API credentials? Set to true when rbac.create is true so the agent can access the K8s API.",
                    "type": "boolean"
                },
                "create": {
                    "type": "boolean"
                },
                "name": {
                    "description": "ServiceAccount name. Required when serviceAccount.create=false and rbac.create=true.",
                    "type": "string"
                }
            }
        },
        "skills": {
            "description": "Skills injection from a ConfigMap archive (created by an external tool; e.g. `obol openclaw skills sync`). The archive is extracted to `extractDir` by a busybox init container and wired into OpenClaw via `skills.load.extraDirs` in _helpers.tpl. Note: ConfigMap total size is limited to ~1 MB by Kubernetes.",
            "type": "object",
            "properties": {
                "archiveKey": {
                    "type": "string"
                },
                "configMapName": {
                    "description": "Name of the ConfigMap containing the skills archive (overrides createDefault)",
                    "type": "string"
                },
                "createDefault": {
                    "description": "Create a default empty skills ConfigMap when configMapName is not set. This allows the chart to deploy without requiring an external ConfigMap. Use `obol openclaw skills sync` to populate it later.",
                    "type": "boolean"
                },
                "enabled": {
                    "type": "boolean"
                },
                "extractDir": {
                    "type": "string"
                },
                "initContainer": {
                    "type": "object",
                    "properties": {
                        "image": {
                            "type": "object",
                            "properties": {
                                "pullPolicy": {
                                    "type": "string"
                                },
                                "repository": {
                                    "type": "string"
                                },
                                "tag": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        },
        "startupProbe": {
            "description": "Startup probe (tcpSocket; allows generous boot time before liveness kicks in)",
            "type": "object",
            "properties": {
                "enabled": {
                    "type": "boolean"
                },
                "failureThreshold": {
                    "type": "integer"
                },
                "periodSeconds": {
                    "type": "integer"
                },
                "timeoutSeconds": {
                    "type": "integer"
                }
            }
        },
        "tolerations": {
            "type": "array"
        }
    }
}
